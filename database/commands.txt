use fifa

db.divisions.find().forEach(function(division) {
    comp = db.competitions.findOne({ name: division.competitionId })._id;
    db.divisions.update({ _id: division._id }, { $set: { competitionId: comp }});
});

db.teamsins.find().forEach(function(teamsIn) {
    comp = db.competitions.findOne({ name: teamsIn.saveId })._id;
    div = db.divisions.findOne({ competitionId: comp, name: teamsIn.divisionId })._id;
    game = db.saves.findOne({ user: teamsIn.gameId }).game;
    save = db.saves.findOne({ user: teamsIn.gameId })._id;
    team = db.teams.findOne({ name: teamsIn.teamId })._id;
    db.teamsins.update({ _id: teamsIn._id }, { $set: { saveId: save, gameId: game, divisionId: div , teamId: team }});
});

db.playerdynamicinfos.find().forEach(function(player) {
    db.playerstaticinfos.insert({
        firstName: player.firstName,
        lastName: player.lastName,
        birthDate: new Date(player.birthDate),
        foot: player.foot
    });
    id = db.playerstaticinfos.findOne({
        firstName: player.firstName,
        lastName: player.lastName,
        birthDate: new Date(player.birthDate),
        foot: player.foot })._id;
    team = db.teams.findOne({ name: player.team })._id;
    db.playerfors.insert({
        teamId: team,
        playerId: player._id
    });
    db.playerdynamicinfos.update(
        { _id: player._id },
        { $set: { 
            saveId: save,
            playerId: id,
            contractExpiration: new Date(player.contractExpiration)
          },
          $unset: { 
            firstName: "",
            lastName: "",
            birthDate: "",
            foot: ""
          }});
});